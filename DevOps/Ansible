Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ansible Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ pipx.
pipx Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ ÑƒÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°Ñ‚ÑŒ Python-Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð² Ð¸Ð·Ð¾Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð¾Ð¼ Ñ‡ÐµÑ€ÐµÐ· Ð³Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ñ‹Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹.

1. ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚Ðµ ÑÐ¿Ð¸ÑÐ¾Ðº Ð¿Ð°ÐºÐµÑ‚Ð¾Ð²:
$ sudo apt update && sudo apt upgrade -y

2. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½ÑƒÑŽ Ð²ÐµÑ€ÑÐ¸ÑŽ Python Ð¸ pip:
$ python3 --version
$ pip3 --version

3. ÐŸÑ€Ð¸ Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ð¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ñ‹Ðµ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸: Ansible Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ Python Ð²ÐµÑ€ÑÐ¸Ð¸ 3.8 Ð¸Ð»Ð¸ Ð²Ñ‹ÑˆÐµ.
$ sudo apt install -y python3 python3-pip python3-venv python3-wheel

4. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ pipx:
$ python3 -m pip install --user pipx
$ python3 -m pipx ensurepath

5. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ Ansible Ñ‡ÐµÑ€ÐµÐ· pipx:
$ pipx install ansible

6. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÑƒ:
$ ansible --version


ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ñ:
Ñ„Ð»Ð°Ð³ --user Ð½Ðµ Ð½ÑƒÐ¶Ð½Ð¾ Ð¼ÐµÐ½ÑÑ‚ÑŒ Ð½Ð° Ð²Ð°ÑˆÐµ Ð¸Ð¼Ñ.
Ð¤Ð»Ð°Ð³ --user Ð² ÐºÐ¾Ð¼Ð°Ð½Ð´Ðµ Ð¾Ð·Ð½Ð°Ñ‡Ð°ÐµÑ‚, Ñ‡Ñ‚Ð¾ Ð¿Ð°ÐºÐµÑ‚ Ð±ÑƒÐ´ÐµÑ‚ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ, Ð° Ð½Ðµ Ð³Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð¾ Ð´Ð»Ñ Ð²ÑÐµÐ¹ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹.
Ð­Ñ‚Ð¾ ÑƒÐ¿Ñ€Ð¾Ñ‰Ð°ÐµÑ‚ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÑƒ, Ð½Ðµ Ñ‚Ñ€ÐµÐ±ÑƒÑ Ð¿Ñ€Ð°Ð² ÑÑƒÐ¿ÐµÑ€Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ (sudo), Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ Ð² Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸Ð¸ ~/.local.
ÐŸÐ°ÐºÐµÑ‚ pipx Ð±ÑƒÐ´ÐµÑ‚ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½ Ð² Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸ÑŽ ~/.local/lib/python3.x/site-packages/.
Ð˜ÑÐ¿Ð¾Ð»Ð½ÑÐµÐ¼Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ pipx (Ð¸ Ð´Ñ€ÑƒÐ³Ð¸Ñ… ÑƒÑ‚Ð¸Ð»Ð¸Ñ‚, ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ñ… Ñ‡ÐµÑ€ÐµÐ· Ð½ÐµÐ³Ð¾) Ð¾ÐºÐ°Ð¶ÑƒÑ‚ÑÑ Ð² ~/.local/bin/.


Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ñ‡Ñ‚Ð¾ ~/.local/bin Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ Ð² Ð²Ð°Ñˆ PATH:
$ echo $PATH
Ð•ÑÐ»Ð¸ ~/.local/bin Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚, Ð´Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ ÐµÐ³Ð¾ Ð² Ñ„Ð°Ð¹Ð» ~/.bashrc Ð¸Ð»Ð¸ ~/.zshrc.
ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ Ñ„Ð°Ð¹Ð» ~/.bashrc (Ð¸Ð»Ð¸ ~/.zshrc, ÐµÑÐ»Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚Ðµ Zsh):
$ nano ~/.bashrc
Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ ÑÑ‚Ñ€Ð¾ÐºÑƒ:
export PATH=$PATH:~/.local/bin

ÐŸÑ€Ð¸Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ:
$ source ~/.bashrc

Ð¢ÐµÐ¿ÐµÑ€ÑŒ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð° pipx Ð±ÑƒÐ´ÐµÑ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð° Ð¸Ð· Ð²Ð°ÑˆÐµÐ³Ð¾ Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð»Ð°. ÐŸÐ¾ÑÐ»Ðµ ÑÑ‚Ð¾Ð³Ð¾ Ð²Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ pipx Ð´Ð»Ñ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ Ð¸ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸ÑÐ¼Ð¸, Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€:
pipx install ansible


ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ansible (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)

1. Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸ÑŽ Ð´Ð»Ñ Ñ„Ð°Ð¹Ð»Ð¾Ð² ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸:
$ mkdir -p ~/ansible/playbooks
2. ÐŸÑ€Ð¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ÑÑ‚Ð¸, ÑÐ¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ñ„Ð°Ð¹Ð» ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸ ansible.cfg:
$ nano ~/ansible/ansible.cfg

ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð¹ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸:
[defaults]
inventory = ~/ansible/hosts
host_key_checking = False
retry_files_enabled = False

3. Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ñ„Ð°Ð¹Ð» hosts Ð´Ð»Ñ Ð¸Ð½Ð²ÐµÐ½Ñ‚Ð°Ñ€Ñ:
$ nano ~/ansible/hosts
ÐŸÑ€Ð¸Ð¼ÐµÑ€ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ð³Ð¾:
[local]
localhost ansible_connection=local
[ubuntu_server]
your_server_ip ansible_user=your_user ansible_ssh_private_key_file=~/.ssh/your_private_key ansible_port=22

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð²Ñ‹ Ð³Ð¾Ñ‚Ð¾Ð²Ñ‹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ansible! ðŸŽ‰


Ð”Ð»Ñ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ðº ÑƒÐ´Ð°Ð»Ñ‘Ð½Ð½Ð¾Ð¼Ñƒ Ubuntu Server Ð² Ð¾Ð±Ð»Ð°ÐºÐµ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ansible Ð¿Ð¾Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ ÑƒÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð°, Ñ‚Ð°ÐºÐ¸Ðµ ÐºÐ°Ðº IP-Ð°Ð´Ñ€ÐµÑ ÑÐµÑ€Ð²ÐµÑ€Ð°, Ð¸Ð¼Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¸ ÑÐ¿Ð¾ÑÐ¾Ð± Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ (Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾ SSH).
ÐŸÑ€Ð¸Ð¼ÐµÑ€ ÑÑ‚Ñ€Ð¾ÐºÐ¸ Ð² Ð¸Ð½Ð²ÐµÐ½Ñ‚Ð°Ñ€Ð½Ð¾Ð¼ Ñ„Ð°Ð¹Ð»Ðµ Ð´Ð»Ñ ÑƒÐ´Ð°Ð»Ñ‘Ð½Ð½Ð¾Ð³Ð¾ ÑÐµÑ€Ð²ÐµÑ€Ð°:
[ubuntu_server]
your_server_ip ansible_user=your_user ansible_ssh_private_key_file=~/.ssh/your_private_key ansible_port=22

ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹:

    your_server_ip â€” Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ñ‹Ð¹ IP-Ð°Ð´Ñ€ÐµÑ Ð²Ð°ÑˆÐµÐ³Ð¾ Ð¾Ð±Ð»Ð°Ñ‡Ð½Ð¾Ð³Ð¾ ÑÐµÑ€Ð²ÐµÑ€Ð°.
    ansible_user â€” Ð¸Ð¼Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð´Ð»Ñ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, ubuntu Ð´Ð»Ñ ÑÐµÑ€Ð²ÐµÑ€Ð¾Ð² Ubuntu, ÑÐ¾Ð·Ð´Ð°Ð½Ð½Ñ‹Ñ… Ñ‡ÐµÑ€ÐµÐ· Ð±Ð¾Ð»ÑŒÑˆÐ¸Ð½ÑÑ‚Ð²Ð¾ Ð¾Ð±Ð»Ð°Ñ‡Ð½Ñ‹Ñ… Ð¿Ñ€Ð¾Ð²Ð°Ð¹Ð´ÐµÑ€Ð¾Ð²).
    ansible_ssh_private_key_file â€” Ð¿ÑƒÑ‚ÑŒ Ðº Ð²Ð°ÑˆÐµÐ¼Ñƒ Ð¿Ñ€Ð¸Ð²Ð°Ñ‚Ð½Ð¾Ð¼Ñƒ SSH-ÐºÐ»ÑŽÑ‡Ñƒ, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸.
    ansible_port â€” Ð¿Ð¾Ñ€Ñ‚ Ð´Ð»Ñ SSH (Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ 22, Ð½Ð¾ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð¸Ð·Ð¼ÐµÐ½Ñ‘Ð½ Ð² Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°Ñ… ÑÐµÑ€Ð²ÐµÑ€Ð°).

Ð•ÑÐ»Ð¸ ÑÐµÑ€Ð²ÐµÑ€ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ Ð´Ð»Ñ SSH:
Ð•ÑÐ»Ð¸ Ð²Ñ‹ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ Ð²Ð¼ÐµÑÑ‚Ð¾ ÐºÐ»ÑŽÑ‡Ð° (Ð½Ðµ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸), Ð¼Ð¾Ð¶Ð½Ð¾ ÑƒÐºÐ°Ð·Ð°Ñ‚ÑŒ:
192.168.1.100 ansible_user=your_user ansible_ssh_pass=your_password ansible_port=22
ÐÐ¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð°Ñ€Ð¾Ð»Ñ Ð½ÐµÐ±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾; Ð»ÑƒÑ‡ÑˆÐµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ ÐºÐ»ÑŽÑ‡Ð¸ SSH.

ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð¿Ð¾Ð»Ð½Ð¾Ð³Ð¾ Ð¸Ð½Ð²ÐµÐ½Ñ‚Ð°Ñ€Ð½Ð¾Ð³Ð¾ Ñ„Ð°Ð¹Ð»Ð°
[local]
localhost ansible_connection=local

[cloud_servers]
192.168.1.100 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/aws-key.pem ansible_port=22
192.168.1.101 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/aws-key.pem ansible_port=22

Ð¢ÐµÑÑ‚ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ
Ð”Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ:
$ ansible -i ~/ansible/hosts ubuntu_server -m ping

-i ~/ansible/hosts â€” Ð¿ÑƒÑ‚ÑŒ Ðº Ð²Ð°ÑˆÐµÐ¼Ñƒ Ð¸Ð½Ð²ÐµÐ½Ñ‚Ð°Ñ€Ð½Ð¾Ð¼Ñƒ Ñ„Ð°Ð¹Ð»Ñƒ.
ubuntu_server â€” Ð³Ñ€ÑƒÐ¿Ð¿Ð° Ð¸Ð»Ð¸ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ð¹ Ñ…Ð¾ÑÑ‚ Ð¸Ð· Ñ„Ð°Ð¹Ð»Ð°.
-m ping â€” Ð¼Ð¾Ð´ÑƒÐ»ÑŒ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ ÑÐ²ÑÐ·Ð¸.

Ð•ÑÐ»Ð¸ Ð²ÑÑ‘ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¾ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾, Ð²Ñ‹ ÑƒÐ²Ð¸Ð´Ð¸Ñ‚Ðµ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ñ‚Ð¸Ð¿Ð°:
192.168.1.100 | SUCCESS => {
    "changed": false,
    "ping": "pong"
}



