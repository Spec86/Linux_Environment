‚ùì –ö–û–ì–î–ê –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å CSR –∏ –∫–ª—é—á ‚Äî –î–û –∏–ª–∏ –ü–û–°–õ–ï –ø–æ–∫—É–ø–∫–∏?
‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
    –ú–û–ñ–ù–û –∏ –î–û, –∏ –ü–û–°–õ–ï,
    –Ω–æ –ù–ê –ü–†–ê–ö–¢–ò–ö–ï ‚Äî –ü–û–°–õ–ï –Ω–∞—á–∞–ª–∞ –∑–∞–∫–∞–∑–∞ SSL.

–ü–æ—á–µ–º—É:
    –ø—Ä–æ–¥–∞–≤—Ü—É –Ω—É–∂–µ–Ω CSR
    –±–µ–∑ CSR —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ–ª—å–∑—è –≤—ã–ø—É—Å—Ç–∏—Ç—å
    –¥–µ–Ω—å–≥–∏ ‚â† —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç




üß≠ –†–ï–ê–õ–¨–ù–´–ô –ø–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π (–∫–∞–∫ –≤ –∂–∏–∑–Ω–∏)
–®–∞–≥ 1Ô∏è‚É£ ‚Äî –í—ã–±–∏—Ä–∞–µ—à—å SSL –∏ –æ–ø–ª–∞—á–∏–≤–∞–µ—à—å
    –ù–∞ —Å–∞–π—Ç–µ –ø—Ä–æ–¥–∞–≤—Ü–∞ (Sectigo, DigiCert, GlobalSign, Namecheap –∏ —Ç.–ø.):

–í—ã–±–∏—Ä–∞–µ—à—å:
    Domain Validation (DV) ‚Äî –¥–ª—è —Å–∞–π—Ç–∞ ‚úî

–í–≤–æ–¥–∏—à—å –¥–æ–º–µ–Ω:
    example.com

–ü–õ–ê–¢–ò–®–¨ –∫–∞—Ä—Ç–æ–π
    üí≥ –ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ:
    ‚ùå CSR –Ω–µ –Ω—É–∂–µ–Ω
    ‚ùå –∫–ª—é—á–∏ –Ω–µ –Ω—É–∂–Ω—ã
    ‚ùå OpenSSL –Ω–µ –Ω—É–∂–µ–Ω
    üëâ –ü—Ä–æ—Å—Ç–æ –æ—Ñ–æ—Ä–º–∏–ª –∑–∞–∫–∞–∑


–®–∞–≥ 2Ô∏è‚É£ ‚Äî –ó–∞–∫–∞–∑ –≤ —Å—Ç–∞—Ç—É—Å–µ ‚ÄúPending / Awaiting CSR‚Äù
    –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –ø–æ—è–≤–∏—Ç—Å—è:
    üî∏ Provide CSR
    üî∏ Paste your CSR here
    üìå –í–û–¢ –¢–£–¢ —Ç–µ–±–µ –∏ –Ω—É–∂–µ–Ω CSR


üîê –®–∞–≥ 3Ô∏è‚É£ ‚Äî –¢–ï–ü–ï–†–¨ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—à—å CSR –∏ –∫–ª—é—á (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
    üëâ –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –£ –°–ï–ë–Ø –Ω–∞ VPS, –Ω–µ –Ω–∞ —Å–∞–π—Ç–µ –ø—Ä–æ–¥–∞–≤—Ü–∞.

sudo mkdir -p /etc/nginx/ssl/MyCompanyName.com
cd /etc/nginx/ssl/MyCompanyName.com


sudo openssl req -new -newkey rsa:2048 -nodes \
  -keyout privkey.key \
  -out request.csr

–¢–µ–±—è —Å–ø—Ä–æ—Å—è—Ç:
‚ùì –ì–¥–µ —Ç–µ–±—è –°–ü–†–û–°–Ø–¢ —ç—Ç–∏ –ø–æ–ª—è?
    ‚ùå –ù–ï –Ω–∞ —Å–∞–π—Ç–µ –ø—Ä–æ–¥–∞–≤—Ü–∞
    ‚úÖ –í –¢–ï–†–ú–ò–ù–ê–õ–ï, –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å
    –í–æ—Ç –∑–¥–µ—Å—å:
        Country Name (2 letter code) [AU]: JP
        State or Province Name: Tokyo
        Locality Name: Tokyo
        Organization Name: MyCompanyName
        Organizational Unit Name: IT
        Common Name: MyCompanyName.com
        Email Address: admin@MyCompanyName.com


üìå –ü—Ä–æ–¥–∞–≤–µ—Ü –ù–ò–ß–ï–ì–û —ç—Ç–æ–≥–æ –Ω–µ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç, –∫—Ä–æ–º–µ CSR.

üßæ –ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å request.csr
    –û—Ç–∫—Ä–æ–π —Ñ–∞–π–ª:
        cat request.csr

–û–Ω –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:
    -----BEGIN CERTIFICATE REQUEST-----
    MIIC1DCCAbwCAQAw...
    ...
    -----END CERTIFICATE REQUEST-----

    üîπ –ö–û–ü–ò–†–£–ï–®–¨ –í–ï–°–¨ –¢–ï–ö–°–¢
    üîπ –í—Å—Ç–∞–≤–ª—è–µ—à—å –≤ —Ñ–æ—Ä–º—É –ø—Ä–æ–¥–∞–≤—Ü–∞ SSL


üß™ –®–∞–≥ 4Ô∏è‚É£ ‚Äî –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–æ–º–µ–Ω–∞ (DV)
    –ü—Ä–æ–¥–∞–≤–µ—Ü –ø—Ä–µ–¥–ª–æ–∂–∏—Ç 1 –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤:
    ‚úÖ Email (—Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π)
        admin@example.com
        hostmaster@
        postmaster@
        webmaster@

    –¢—ã:
        –≤—ã–±–∏—Ä–∞–µ—à—å email
        –ø–æ–ª—É—á–∞–µ—à—å –ø–∏—Å—å–º–æ
        –Ω–∞–∂–∏–º–∞–µ—à—å —Å—Å—ã–ª–∫—É
        üìå –ù–∏–∫–∞–∫–∏—Ö –ª–æ–≥–∏–Ω–æ–≤/–ø–∞—Ä–æ–ª–µ–π

    ‚úÖ DNS (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)
    –¢–µ–±–µ –¥–∞–¥—É—Ç –∑–∞–ø–∏—Å—å:
        Type: TXT
        Name: _abc123.MyCompanyName.com
        Value: xyz987
    –¢—ã –¥–æ–±–∞–≤–ª—è–µ—à—å –µ—ë –≤ DNS.


üì¶ –®–∞–≥ 5Ô∏è‚É£ ‚Äî –ü–æ–ª—É—á–∞–µ—à—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
    –ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –¥–æ–º–µ–Ω–∞ —Ç–µ–±–µ –¥–∞—é—Ç:
        certificate.crt
        ca_bundle.crt
    –∏–ª–∏ zip-–∞—Ä—Ö–∏–≤.

üóÇ –®–∞–≥ 6Ô∏è‚É£ ‚Äî –ö—É–¥–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª—ã
/etc/nginx/ssl/MyCompanyName.com/
‚îú‚îÄ‚îÄ privkey.key        ‚Üê —É–∂–µ –µ—Å—Ç—å
‚îú‚îÄ‚îÄ certificate.crt    ‚Üê –¢–û–õ–¨–ö–û –ß–¢–û –ü–û–õ–£–ß–ò–õ
‚îú‚îÄ‚îÄ ca_bundle.crt      ‚Üê –¢–û–õ–¨–ö–û –ß–¢–û –ü–û–õ–£–ß–ò–õ
‚îî‚îÄ‚îÄ fullchain.crt

–°–æ–±–∏—Ä–∞–µ–º —Ü–µ–ø–æ—á–∫—É (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
sudo cat certificate.crt ca_bundle.crt > fullchain.crt


–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (–ö–†–ò–¢–ò–ß–ù–û)
    sudo chown -R root:root /etc/nginx/ssl/MyCompanyName.com
    sudo chmod 600 /etc/nginx/ssl/MyCompanyName.com/privkey.key
    sudo chmod 644 /etc/nginx/ssl/MyCompanyName.com/*.crt




–ö–∞–∫ –ø—Ä–æ–ø–∏—Å–∞—Ç—å SSL –≤ Nginx
/etc/nginx/sites-available/MyCompanyName.conf

server {
    listen 443 ssl;
    server_name MyCompanyName.com www.MyCompanyName.com;

    ssl_certificate     /etc/nginx/ssl/MyCompanyName.com/fullchain.crt;
    ssl_certificate_key /etc/nginx/ssl/MyCompanyName.com/privkey.key;

    location / {
        proxy_pass http://127.0.0.1:5000;

        proxy_set_header Host $host;
        proxy_set_header X-Forwarded-Proto https;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}

server {
    listen 80;
    server_name MyCompanyName.com www.MyCompanyName.com;
    return 301 https://$host$request_uri;
}

–ü—Ä–æ–≤–µ—Ä–∫–∞:

sudo nginx -t
sudo systemctl reload nginx



‚ùó –í–ê–ñ–ù–û: —á—Ç–æ –ù–ò–ö–û–ì–î–ê –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
| –ú–∏—Ñ                      | –†–µ–∞–ª—å–Ω–æ—Å—Ç—å  |
| ------------------------ | ----------- |
| –ü—Ä–æ–¥–∞–≤–µ—Ü –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–ª—é—á | ‚ùå –ù–ò–ö–û–ì–î–ê   |
| –ü—Ä–æ–¥–∞–≤–µ—Ü –¥–∞—ë—Ç –ø–∞—Ä–æ–ª—å     | ‚ùå –ù–ï–¢       |
| –ö–ª—é—á –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –Ω–∞ —Å–∞–π—Ç | ‚ùå –ó–ê–ü–†–ï–©–ï–ù–û |
| –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç = –ø–æ–∫—É–ø–∫–∞     | ‚ùå –Ω—É–∂–µ–Ω CSR |


üîÅ –ö–æ—Ä–æ—Ç–∫–∞—è —Å—Ö–µ–º–∞ (—á—Ç–æ–±—ã –∑–∞–ø–æ–º–Ω–∏—Ç—å)
    1. –ö—É–ø–∏–ª SSL
    2. –ó–∞–∫–∞–∑ "Waiting for CSR"
    3. –°–ì–ï–ù–ï–†–ò–õ CSR + –∫–ª—é—á
    4. –í–°–¢–ê–í–ò–õ CSR
    5. –ü–û–î–¢–í–ï–†–î–ò–õ –î–û–ú–ï–ù
    6. –ü–û–õ–£–ß–ò–õ .crt
    7. –ü–û–î–ö–õ–Æ–ß–ò–õ –í Nginx

üß† –ê–Ω–∞–ª–æ–≥–∏—è —Å Java (—á—Ç–æ–±—ã –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ –ª–µ–≥–ª–æ)
| Java            | Nginx                   |
| --------------- | ----------------------- |
| keytool -genkey | openssl req             |
| .jks            | privkey.key             |
| CSR             | request.csr             |
| keystore pass   | passphrase (–æ–±—ã—á–Ω–æ –Ω–µ—Ç) |


–ß—Ç–æ –ù–ï–õ–¨–ó–Ø –¥–µ–ª–∞—Ç—å
    ‚ùå –ö–æ–º–º–∏—Ç–∏—Ç—å –∫–ª—é—á –≤ Git
    ‚ùå –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –ª–æ–∫–∞–ª–∫—É
    ‚ùå –û—Ç–¥–∞–≤–∞—Ç—å SSL-–ø—Ä–æ–≤–∞–π–¥–µ—Ä—É
    ‚ùå –î–µ–ª–∞—Ç—å chmod 777


üéØ –ò—Ç–æ–≥ (–∫–æ—Ä–æ—Ç–∫–æ)
–¢—ã –ø–æ–ª—É—á–∞–µ—à—å:
    ‚ùå –ª–æ–≥–∏–Ω–æ–≤/–ø–∞—Ä–æ–ª–µ–π ‚Äî –ù–ï–¢
    ‚úÖ privkey.key ‚Äî –¢–í–û–ô
    ‚úÖ certificate.crt ‚Äî –ò–•
    ‚úÖ ca_bundle.crt ‚Äî –ò–•
    ‚úÖ fullchain.crt ‚Äî –°–û–ë–ò–†–ê–ï–®–¨ –°–ê–ú
    ‚úÖ Nginx –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 2 —Ñ–∞–π–ª–∞

